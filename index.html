<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RoboEyes Fixed</title>
  <style>
    /* ... existing styles ... */
  </style>
</head>
<body>
  <canvas id="roboEyes" width="128" height="64"></canvas>
  <div class="controls">
    <!-- ... existing controls ... -->
  </div>

  <script>
    const canvas = document.getElementById("roboEyes");
    const ctx = canvas.getContext("2d");

    // Helper function for rounded rectangles
    function drawRoundedRect(x, y, width, height, radius) {
      ctx.beginPath();
      ctx.moveTo(x + radius, y);
      ctx.lineTo(x + width - radius, y);
      ctx.arcTo(x + width, y, x + width, y + radius, radius);
      ctx.lineTo(x + width, y + height - radius);
      ctx.arcTo(x + width, y + height, x + width - radius, y + height, radius);
      ctx.lineTo(x + radius, y + height);
      ctx.arcTo(x, y + height, x, y + height - radius, radius);
      ctx.lineTo(x, y + radius);
      ctx.arcTo(x, y, x + radius, y, radius);
      ctx.closePath();
    }

    // Expression definitions (unchanged)
    const expressions = { /* ... */ };

    // Draw eyes and eyebrows
    function drawEyes() {
      ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas first

      const expr = expressions[currentExpression];
      const { color, width, height, spacing, eyebrow } = expr;

      // Draw eyebrows
      if (eyebrow) {
        ctx.strokeStyle = eyebrow.color;
        ctx.lineWidth = eyebrow.thickness;
        ctx.beginPath();

        const leftX = 32 + eyeOffset;
        const rightX = 32 + spacing + eyeOffset;
        const y = 20;

        // Adjusted eyebrow positions
        ctx.moveTo(leftX - 10, y); // Shift left
        ctx.lineTo(leftX + width + (spacing * 0.5) + 10, y + (height * eyebrow.angle)); // Shift right

        ctx.moveTo(rightX - 10, y); // Shift left
        ctx.lineTo(rightX + width + (spacing * 0.5) + 10, y + (height * eyebrow.angle)); // Shift right

        ctx.stroke();
      }

      // Draw eyes
      ctx.fillStyle = color;
      ctx.strokeStyle = "#000";
      ctx.lineWidth = 2;

      const leftX = 32 + eyeOffset;
      const rightX = 32 + spacing + eyeOffset;

      // Left eye
      drawRoundedRect(leftX, 24, width, height, 5);
      ctx.fill();
      ctx.stroke();

      // Right eye
      drawRoundedRect(rightX, 24, width, height, 5);
      ctx.fill();
      ctx.stroke();

      // Sad teardrop (unchanged)
      if (currentExpression === "sad") {
        // ... existing code ...
      }
    }

    // Rest of the code (blink, curiosity, fullscreen) remains the same
  </script>
</body>
</html>
